(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{8992:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/webGL",function(){return n(8631)}])},752:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});var o=n(7294);let i=()=>{let[e,t]=(0,o.useState)([0,0]);return(0,o.useLayoutEffect)(()=>{let e=()=>{t([document.documentElement.clientWidth,document.documentElement.clientHeight])};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}},9391:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var o=n(4386),i=n(7294),a=n(9477);let r={絵トリス:[["0","0","1","0","0","0","0","0","8","0","0","0","0","0","d","0","0","0","0","0","0","0","0","0","0","i","0","0","0","0","0","0","0","0","0"],["0","1","0","0","0","0","0","7","0","8","0","0","0","0","d","0","0","0","0","0","0","h","0","0","0","i","0","0","0","l","l","l","l","m","0"],["1","0","0","0","0","0","0","7","0","8","0","0","0","0","d","0","0","0","0","0","0","h","0","0","0","i","0","0","0","0","0","0","0","m","0"],["0","1","0","2","0","0","7","0","0","0","8","0","0","0","d","0","0","0","0","0","0","h","0","0","0","i","0","0","0","0","0","0","m","0","0"],["0","0","2","0","0","7","0","9","9","9","0","8","0","0","e","e","g","0","0","0","0","h","0","0","0","j","0","0","0","0","0","0","m","0","0"],["0","2","0","6","6","0","0","0","0","0","0","0","0","0","e","0","g","0","0","0","0","0","0","0","0","j","0","0","0","0","0","n","0","0","0"],["2","3","3","3","6","0","a","a","a","a","a","0","0","0","e","0","0","g","0","0","0","0","0","0","0","j","0","0","0","0","0","n","0","0","0"],["0","0","4","0","6","0","0","0","b","0","0","0","0","0","f","0","0","0","g","0","0","0","0","0","k","j","0","0","0","0","o","0","n","0","0"],["0","4","5","5","0","0","0","b","0","0","c","0","0","0","f","0","0","0","0","0","0","0","0","0","k","0","0","0","0","0","o","0","n","0","0"],["4","0","5","0","5","0","b","b","c","c","c","0","0","0","f","0","0","0","0","0","0","0","0","0","k","0","0","0","0","o","0","0","0","p","0"],["0","0","5","0","0","0","0","0","0","0","0","c","0","0","f","0","0","0","0","0","0","0","0","k","0","0","0","0","0","o","0","0","0","p","p"]],members:[["1","2","2","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","k","l","l"],["1","2","2","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","k","k","l"],["1","1","2","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","k","l","l"],["0","0","0","0","9","9","0","0","0","0","0","0","0","0","0","j","j","0","0","0","0"],["0","0","0","0","9","9","0","0","0","0","0","0","0","0","0","j","j","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","b","b","c","0","0","0","i","i","i","0","0","0","0","0","0"],["0","3","3","0","0","0","b","c","c","0","0","0","h","i","i","0","0","0","m","m","0"],["0","3","3","0","0","0","b","c","c","0","0","0","h","h","h","0","0","0","m","m","0"],["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],["0","0","0","0","a","a","0","0","0","e","e","e","0","0","0","n","n","0","0","0","0"],["0","0","0","0","a","a","0","0","0","e","f","f","0","0","0","n","n","0","0","0","0"],["0","0","0","0","0","0","0","0","0","f","f","f","0","0","0","0","0","0","0","0","0"],["4","4","4","7","0","0","0","0","0","0","0","0","0","0","0","0","0","o","p","p","p"],["4","5","7","7","0","0","0","0","0","0","0","0","0","0","0","0","0","o","o","q","p"],["6","5","5","7","0","0","d","d","0","0","0","0","0","g","g","0","0","s","o","q","q"],["6","6","5","8","0","0","d","d","0","0","0","0","0","g","g","0","0","s","r","r","q"],["6","8","8","8","0","0","0","0","0","0","0","0","0","0","0","0","0","s","s","r","r"]]},l=e=>({x:10*(1-2*Math.random()),y:10*(1-2*Math.random()),z:10*(1-2*Math.random()),rotateX:.01*Math.PI*Math.random(),rotateY:.01*Math.PI*Math.random(),rotateZ:.01*Math.PI*Math.random(),count:e,direction:0}),s=i.memo(e=>{let{type:t,w:n,vw:s,h:d,vh:c,fontColor:m,...p}=e,u=(0,i.useRef)(null),[h,f]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{window.addEventListener("resize",()=>{f(!h)});let e=r[t],o=e[0].length,i=e.length,p=0,g=0;s||n?g=i*(p=s?s/100*window.innerWidth:n)/o:p=o*(g=c?c/100*window.innerHeight:d)/i;let w=new a.CP7({alpha:!0}),M=u.current;null==M||M.appendChild(w.domElement),w.setPixelRatio(window.devicePixelRatio),w.setSize(p,g),w.setClearColor(0,0);let b=new a.xsS,x=new a.cPb(40,p/g,1,15e3);x.position.z=p/2,x.position.x=p/2,x.position.y=g/2;let v={},E=e.length,y=e[0].length,S=p/y;for(let t=0;t<E;t++)for(let n=0;n<y;n++){let o=e[t][n];if("0"===o)continue;if(!(o in v)){let e=new a.ZAu;v[o]={mino:e,speed:l(-(8*Object.keys(v).length))}}let i=new a.DvJ(S,S,S),r=new a.IKL({color:m}),s=new a.Kj0(i,r);s.position.x=n*S,s.position.y=(E-1-t)*S,s.position.z=0,s.matrixAutoUpdate=!1,s.updateMatrix(),v[o].mino.add(s)}let I=Object.keys(v);for(let e of I)b.add(v[e].mino);let _=new a.Ox3(16777215);_.position.set(1,1,1),b.add(_);let P=()=>{for(let e of I){let t=v[e];300===t.speed.count&&(t.speed.direction=1),500===t.speed.count&&(t.speed.direction=-1),700===t.speed.count&&(t.speed.direction=0,t.speed.count=0,t.speed=l(0)),t.speed.count++,t.mino.position.x+=t.speed.direction*t.speed.x,t.mino.position.y+=t.speed.direction*t.speed.y,t.mino.position.z+=t.speed.direction*t.speed.z,t.mino.rotation.x+=t.speed.direction*t.speed.rotateX,t.mino.rotation.y+=t.speed.direction*t.speed.rotateY,t.mino.rotation.z+=t.speed.direction*t.speed.rotateZ}},L=()=>{w.render(b,x),P(),requestAnimationFrame(L)};return L(),()=>{null==M||M.removeChild(w.domElement)}},[h,t,n,s,d,c,m]),(0,o.tZ)("div",{ref:u,...p})});s.displayName="TetrisText";var d=s},8631:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var o=n(4386),i=n(917),a=n(3631),r=n(752),l=n(6172),s=n(9391),d=n(3450),c=n(7294),m=n(6358),p=n(9477),u=n(3410);let h=c.memo(e=>{let t=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=1.5*window.innerWidth,n=1.5*window.innerHeight,o=new p.CP7,i=t.current;null==i||i.appendChild(o.domElement),o.setPixelRatio(window.devicePixelRatio),o.setSize(e,n);let a=new p.xsS;a.background=new p.Ilk().setHSL(.51,.4,.01),a.fog=new p.ybr(a.background,3500,15e3);let r=new p.cPb(40,window.innerWidth/window.innerHeight,1,15e3);r.position.z=0,r.position.x=0;let l=new p.DvJ(7,7,7),s=new p.xoR({color:16777215,specular:16777215,shininess:50}),d=(0,u.r)(m.L5.slice()),c=e/12,h=n/24,f=d.length/5|0,g=c/f,w=h/1,M=c/f,b=[];for(let e=0;e<f;e++)for(let t=0;t<1;t++)for(let n=0;n<f;n++)b.push({x:g*e+1+g*Math.random(),y:w*t+w*Math.random(),z:M*n+1+M*Math.random()});let x=[];for(let e=0;e<d.length;e++){let t=d[e],n=0,o=0,i=0;if(b.length>0){let e=b.pop();e&&(n=e.x-c/2,o=e.y-h/2,i=e.z-c/2)}else n=200*(2*Math.random()-1),o=100*(2*Math.random()-1),(i=500*(2*Math.random()-1))>0?i+=600:i-=600;let r=new p.ZAu;x.push(r);for(let a=0;a<t.length;a++)for(let r=0;r<t[a].length;r++){if(""===t[a][r])continue;let d=new p.Kj0(l,s);d.position.x=n+7*r,d.position.y=o-7*a,d.position.z=i,d.name="".concat(e),x[e].add(d)}x[e].position.x=n,x[e].position.y=o,x[e].position.z=i;let m=x[e].quaternion,u=new p._fP,f=new p.Pa4(n,o,i).normalize();u.setFromAxisAngle(f,4*Math.PI*Math.random()),m.multiply(u),a.add(x[e])}let v=new p.cek(16777215,1,1500,2);v.position.set(0,0,0),a.add(v);let E={},y=()=>{for(let e in o.render(a,r),a.rotation.y+=1e-4*Math.PI,E){let{minoNum:t,axis:n,direction:o}=E[e],i=x[t].quaternion,a=new p._fP;a.setFromAxisAngle(n,Math.PI/1500*o.rotate),i.multiply(a),x[t].rotation.x+=1e-4*Math.PI*o.x,x[t].rotation.y+=1e-4*Math.PI*o.y,x[t].rotation.z+=1e-4*Math.PI*o.z}requestAnimationFrame(y)};return y(),document.addEventListener("mousedown",t=>{let o=t.clientX,i=t.clientY,l=new p.FM8;l.x=o/e*2-1,l.y=-(i/n*2)+1;let s=new p.iMs;s.setFromCamera(l,r);let d=s.intersectObjects(a.children);if(d.length>0&&""!==d[0].object.name){let e=d[0].object.name,t=Number(e);e in E?(E[e].direction.rotate*=-1,E[e].direction.x*=1-2*Math.floor(2*Math.random()),E[e].direction.y*=1-2*Math.floor(2*Math.random()),E[e].direction.z*=1-2*Math.floor(2*Math.random())):E["".concat(t)]={minoNum:t,direction:{rotate:1-2*Math.floor(2*Math.random()),x:1-2*Math.floor(2*Math.random()),y:1-2*Math.floor(2*Math.random()),z:1-2*Math.floor(2*Math.random())},axis:new p.Pa4(x[t].position.x,x[t].position.y,x[t].position.z).normalize()}}},!1),()=>{null==i||i.removeChild(o.domElement)}},[e]),(0,o.tZ)("div",{ref:t})});h.displayName="MinoSpace";var f=n(1752),g=n.n(f),w=n(1664),M=n.n(w),b=n(1163),x=n(7541),v=n(6069),E=n.n(v);let{publicRuntimeConfig:y}=g()();var S=()=>{let e=y&&y.basePath||"";(0,c.useLayoutEffect)(u.Q5);let t=(0,b.useRouter)(),n=t.query.MODEL_IMAGE,[p,f]=(0,c.useState)("string"==typeof n?n:null),[g,w]=(0,c.useState)(m.LA.USE_ROTATE[0].label),[v,S]=(0,c.useState)(m.LA.FALL_SPEED[0].label),[I,_]=(0,c.useState)(m.LA.DIVIDER_NUM[0].label);(0,c.useEffect)(()=>{let e=sessionStorage.getItem("modelImage");e&&(0,u.R4)(e).then(e=>{f(e||p)});let t=sessionStorage.getItem("useRotate"),n=sessionStorage.getItem("fallSpeed"),o=sessionStorage.getItem("divider");t&&w(t),n&&S(n),o&&_(o)},[]);let[P,L]=(0,c.useState)(!1),[k,z]=(0,r.N)();return(0,c.useEffect)(()=>{L(!P)},[k,z]),(0,o.tZ)(o.HY,{children:(0,o.BX)("main",{children:[(0,o.tZ)("div",{css:(0,i.iv)({position:"fixed",top:"0",zIndex:"-1"}),children:(0,o.tZ)(h,{reRender:P})}),(0,o.tZ)(M(),{href:"/createImage",css:(0,i.iv)({color:"white",fontSize:"20px",position:"fixed",top:"0",right:"0",padding:"2%",textDecoration:"underline",cursor:"pointer",backgroundColor:"rgba(0,0,0,0.6)",zIndex:"1","@media only screen and (max-width:767px)":{fontSize:"13px"}}),children:"AIで画像を生成する"}),(0,o.tZ)("div",{className:E().title,children:(0,o.tZ)(s.Z,{type:"絵トリス",vh:13.5,fontColor:16777215})}),(0,o.BX)("div",{className:E().contentWrapper,children:[(0,o.tZ)(a.Z,{className:E().uploader,onDrop:e=>{let t=window.URL.createObjectURL(e[0]);f(t),sessionStorage.setItem("modelImage",t)},children:(0,o.BX)("div",{className:E().uploader__wrapper,css:(0,i.iv)({position:"relative"}),children:[(0,o.tZ)("div",{css:(0,i.iv)({height:"100%",display:p?"block":"none"}),children:(0,o.tZ)("img",{alt:"",className:E().uploader__img,src:p||""})}),(0,o.BX)("div",{css:(0,i.iv)({display:p?"none":"block"}),children:[(0,o.tZ)(d.Z,{json:x}),(0,o.tZ)("img",{alt:"クリックして画像をアップロードしてください",src:"".concat(e,"/img/icon/upload.png"),css:(0,i.iv)({position:"absolute",left:"0",right:"0",top:"0",bottom:"0",margin:"auto",width:"13%"})})]})]})}),(0,o.tZ)("div",{className:E().playSetting,children:(0,o.tZ)(l.Z,{labelMaxStringNum:4,settings:[{label:"回転",rollProps:{initLabel:g,options:m.LA.USE_ROTATE,clickCallBack:(e,t)=>{w(t),sessionStorage.setItem("useRotate",t)},valueStringNum:4}},{label:"自動落下",rollProps:{initLabel:v,options:m.LA.FALL_SPEED,clickCallBack:(e,t)=>{S(t),sessionStorage.setItem("fallSpeed",t)},valueStringNum:4}},{label:"分割数",rollProps:{initLabel:I,options:m.LA.DIVIDER_NUM,clickCallBack:(e,t)=>{_(t),sessionStorage.setItem("divider",t)},valueStringNum:4}}]})}),(0,o.BX)("div",{className:"".concat(E().playButtomWrapper," ").concat(p?E().playButtomWrapper__onImage:""),onClick:()=>{p&&t.push({pathname:"play",query:{MODEL_IMAGE:p,USE_ROTATE:g,FALL_SPEED:v,DIVIDER_NUM:I}})},children:[(0,o.tZ)("span",{className:E().playImg}),(0,o.tZ)("span",{className:E().playButton,children:"この画像で遊ぶ"})]})]})]})})}}},function(e){e.O(0,[498,802,737,79,664,901,964,528,888,774,179],function(){return e(e.s=8992)}),_N_E=e.O()}]);