(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{8992:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/webGL",function(){return n(7454)}])},3354:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});var o=n(7294);let i=()=>{let[e,t]=(0,o.useState)([0,0]);return(0,o.useLayoutEffect)(()=>{let e=()=>{t([document.documentElement.clientWidth,document.documentElement.clientHeight])};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}},4859:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var o=n(1965),i=n(7294),a=n(9477);let r={絵トリス:[["0","0","1","0","0","0","0","0","8","0","0","0","0","0","d","0","0","0","0","0","0","0","0","0","0","i","0","0","0","0","0","0","0","0","0"],["0","1","0","0","0","0","0","7","0","8","0","0","0","0","d","0","0","0","0","0","0","h","0","0","0","i","0","0","0","l","l","l","l","m","0"],["1","0","0","0","0","0","0","7","0","8","0","0","0","0","d","0","0","0","0","0","0","h","0","0","0","i","0","0","0","0","0","0","0","m","0"],["0","1","0","2","0","0","7","0","0","0","8","0","0","0","d","0","0","0","0","0","0","h","0","0","0","i","0","0","0","0","0","0","m","0","0"],["0","0","2","0","0","7","0","9","9","9","0","8","0","0","e","e","g","0","0","0","0","h","0","0","0","j","0","0","0","0","0","0","m","0","0"],["0","2","0","6","6","0","0","0","0","0","0","0","0","0","e","0","g","0","0","0","0","0","0","0","0","j","0","0","0","0","0","n","0","0","0"],["2","3","3","3","6","0","a","a","a","a","a","0","0","0","e","0","0","g","0","0","0","0","0","0","0","j","0","0","0","0","0","n","0","0","0"],["0","0","4","0","6","0","0","0","b","0","0","0","0","0","f","0","0","0","g","0","0","0","0","0","k","j","0","0","0","0","o","0","n","0","0"],["0","4","5","5","0","0","0","b","0","0","c","0","0","0","f","0","0","0","0","0","0","0","0","0","k","0","0","0","0","0","o","0","n","0","0"],["4","0","5","0","5","0","b","b","c","c","c","0","0","0","f","0","0","0","0","0","0","0","0","0","k","0","0","0","0","o","0","0","0","p","0"],["0","0","5","0","0","0","0","0","0","0","0","c","0","0","f","0","0","0","0","0","0","0","0","k","0","0","0","0","0","o","0","0","0","p","p"]],members:[["1","2","2","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","k","l","l"],["1","2","2","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","k","k","l"],["1","1","2","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","k","l","l"],["0","0","0","0","9","9","0","0","0","0","0","0","0","0","0","j","j","0","0","0","0"],["0","0","0","0","9","9","0","0","0","0","0","0","0","0","0","j","j","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","b","b","c","0","0","0","i","i","i","0","0","0","0","0","0"],["0","3","3","0","0","0","b","c","c","0","0","0","h","i","i","0","0","0","m","m","0"],["0","3","3","0","0","0","b","c","c","0","0","0","h","h","h","0","0","0","m","m","0"],["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],["0","0","0","0","a","a","0","0","0","e","e","e","0","0","0","n","n","0","0","0","0"],["0","0","0","0","a","a","0","0","0","e","f","f","0","0","0","n","n","0","0","0","0"],["0","0","0","0","0","0","0","0","0","f","f","f","0","0","0","0","0","0","0","0","0"],["4","4","4","7","0","0","0","0","0","0","0","0","0","0","0","0","0","o","p","p","p"],["4","5","7","7","0","0","0","0","0","0","0","0","0","0","0","0","0","o","o","q","p"],["6","5","5","7","0","0","d","d","0","0","0","0","0","g","g","0","0","s","o","q","q"],["6","6","5","8","0","0","d","d","0","0","0","0","0","g","g","0","0","s","r","r","q"],["6","8","8","8","0","0","0","0","0","0","0","0","0","0","0","0","0","s","s","r","r"]]},l=e=>({x:10*(1-2*Math.random()),y:10*(1-2*Math.random()),z:10*(1-2*Math.random()),rotateX:.01*Math.PI*Math.random(),rotateY:.01*Math.PI*Math.random(),rotateZ:.01*Math.PI*Math.random(),count:e,direction:0}),s=i.memo(e=>{let{type:t,w:n,vw:s,h:d,vh:c,fontColor:m,...p}=e,u=(0,i.useRef)(null),[h,f]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{window.addEventListener("resize",()=>{f(!h)});let e=r[t],o=e[0].length,i=e.length,p=0,g=0;s||n?g=i*(p=s?s/100*window.innerWidth:n)/o:p=o*(g=c?c/100*window.innerHeight:d)/i;let w=new a.CP7({alpha:!0}),M=u.current;null==M||M.appendChild(w.domElement),w.setPixelRatio(window.devicePixelRatio),w.setSize(p,g),w.setClearColor(0,0);let x=new a.xsS,b=new a.cPb(40,p/g,1,15e3);b.position.z=p/2,b.position.x=p/2,b.position.y=g/2;let E={},v=e.length,y=e[0].length,S=p/y;for(let t=0;t<v;t++)for(let n=0;n<y;n++){let o=e[t][n];if("0"===o)continue;if(!(o in E)){let e=new a.ZAu;E[o]={mino:e,speed:l(-(8*Object.keys(E).length))}}let i=new a.DvJ(S,S,S),r=new a.IKL({color:m}),s=new a.Kj0(i,r);s.position.x=n*S,s.position.y=(v-1-t)*S,s.position.z=0,s.matrixAutoUpdate=!1,s.updateMatrix(),E[o].mino.add(s)}let I=Object.keys(E);for(let e of I)x.add(E[e].mino);let _=new a.Ox3(16777215);_.position.set(1,1,1),x.add(_);let L=()=>{for(let e of I){let t=E[e];300===t.speed.count&&(t.speed.direction=1),500===t.speed.count&&(t.speed.direction=-1),700===t.speed.count&&(t.speed.direction=0,t.speed.count=0,t.speed=l(0)),t.speed.count++,t.mino.position.x+=t.speed.direction*t.speed.x,t.mino.position.y+=t.speed.direction*t.speed.y,t.mino.position.z+=t.speed.direction*t.speed.z,t.mino.rotation.x+=t.speed.direction*t.speed.rotateX,t.mino.rotation.y+=t.speed.direction*t.speed.rotateY,t.mino.rotation.z+=t.speed.direction*t.speed.rotateZ}},P=()=>{w.render(x,b),L(),requestAnimationFrame(P)};return P(),()=>{null==M||M.removeChild(w.domElement)}},[h,t,n,s,d,c,m]),(0,o.tZ)("div",{ref:u,...p})});s.displayName="TetrisText";var d=s},7454:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var o=n(1965),i=n(7294),a=n(1163),r=n(9008),l=n.n(r),s=n(4780),d=n.n(s),c=n(2690),m=n(2081),p=n(917),u=n(9634),h=n(7541),f=n(6767),g=n(1664),w=n.n(g),M=n(1214),x=n(9477);let b=i.memo(e=>{let t=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=1.5*window.innerWidth,n=1.5*window.innerHeight,o=new x.CP7,i=t.current;null==i||i.appendChild(o.domElement),o.setPixelRatio(window.devicePixelRatio),o.setSize(e,n);let a=new x.xsS;a.background=new x.Ilk().setHSL(.51,.4,.01),a.fog=new x.ybr(a.background,3500,15e3);let r=new x.cPb(40,window.innerWidth/window.innerHeight,1,15e3);r.position.z=0,r.position.x=0;let l=new x.DvJ(7,7,7),s=new x.xoR({color:16777215,specular:16777215,shininess:50}),d=(0,m.r)(c.L5.slice()),p=e/12,u=n/24,h=d.length/5|0,f=p/h,g=u/1,w=p/h,M=[];for(let e=0;e<h;e++)for(let t=0;t<1;t++)for(let n=0;n<h;n++)M.push({x:f*e+1+f*Math.random(),y:g*t+g*Math.random(),z:w*n+1+w*Math.random()});let b=[];for(let e=0;e<d.length;e++){let t=d[e],n=0,o=0,i=0;if(M.length>0){let e=M.pop();e&&(n=e.x-p/2,o=e.y-u/2,i=e.z-p/2)}else n=200*(2*Math.random()-1),o=100*(2*Math.random()-1),(i=500*(2*Math.random()-1))>0?i+=600:i-=600;let r=new x.ZAu;b.push(r);for(let a=0;a<t.length;a++)for(let r=0;r<t[a].length;r++){if(""===t[a][r])continue;let d=new x.Kj0(l,s);d.position.x=n+7*r,d.position.y=o-7*a,d.position.z=i,d.name="".concat(e),b[e].add(d)}b[e].position.x=n,b[e].position.y=o,b[e].position.z=i;let c=b[e].quaternion,m=new x._fP,h=new x.Pa4(n,o,i).normalize();m.setFromAxisAngle(h,4*Math.PI*Math.random()),c.multiply(m),a.add(b[e])}let E=new x.cek(16777215,1,1500,2);E.position.set(0,0,0),a.add(E);let v={},y=()=>{for(let e in o.render(a,r),a.rotation.y+=1e-4*Math.PI,v){let{minoNum:t,axis:n,direction:o}=v[e],i=b[t].quaternion,a=new x._fP;a.setFromAxisAngle(n,Math.PI/1500*o.rotate),i.multiply(a),b[t].rotation.x+=1e-4*Math.PI*o.x,b[t].rotation.y+=1e-4*Math.PI*o.y,b[t].rotation.z+=1e-4*Math.PI*o.z}requestAnimationFrame(y)};return y(),document.addEventListener("mousedown",t=>{let o=t.clientX,i=t.clientY,l=new x.FM8;l.x=o/e*2-1,l.y=-(2*(i/n))+1;let s=new x.iMs;s.setFromCamera(l,r);let d=s.intersectObjects(a.children);if(d.length>0&&""!==d[0].object.name){let e=d[0].object.name,t=Number(e);e in v?(v[e].direction.rotate*=-1,v[e].direction.x*=1-2*Math.floor(2*Math.random()),v[e].direction.y*=1-2*Math.floor(2*Math.random()),v[e].direction.z*=1-2*Math.floor(2*Math.random())):v["".concat(t)]={minoNum:t,direction:{rotate:1-2*Math.floor(2*Math.random()),x:1-2*Math.floor(2*Math.random()),y:1-2*Math.floor(2*Math.random()),z:1-2*Math.floor(2*Math.random())},axis:new x.Pa4(b[t].position.x,b[t].position.y,b[t].position.z).normalize()}}},!1),()=>{null==i||i.removeChild(o.domElement)}},[e]),(0,o.tZ)("div",{ref:t})});b.displayName="MinoSpace";var E=n(3354),v=n(4859),y=()=>{(0,i.useLayoutEffect)(m.Q5);let e=(0,a.useRouter)(),t=e.query.MODEL_IMAGE,[n,r]=(0,i.useState)("string"==typeof t?t:null),[s,g]=(0,i.useState)(c.LA.USE_ROTATE[0].label),[x,y]=(0,i.useState)(c.LA.FALL_SPEED[0].label),[S,I]=(0,i.useState)(c.LA.DIVIDER_NUM[0].label);(0,i.useEffect)(()=>{let e=sessionStorage.getItem("modelImage");if(e){let t=(0,m.R4)(e);t.then(e=>{r(e||n)})}let t=sessionStorage.getItem("useRotate"),o=sessionStorage.getItem("fallSpeed"),i=sessionStorage.getItem("divider");t&&g(t),o&&y(o),i&&I(i)},[]);let[_,L]=(0,i.useState)(!1),[P,k]=(0,E.N)();return(0,i.useEffect)(()=>{L(!_)},[P,k]),(0,o.BX)(o.HY,{children:[(0,o.tZ)(l(),{children:(0,o.tZ)("title",{children:"絵トリス"})}),(0,o.BX)("main",{children:[(0,o.tZ)("div",{css:(0,p.iv)({position:"fixed",top:"0",zIndex:"-1"}),children:(0,o.tZ)(b,{reRender:_})}),(0,o.tZ)(w(),{href:"/createImage",css:(0,p.iv)({color:"white",fontSize:"20px",position:"fixed",top:"0",right:"0",padding:"2%",textDecoration:"underline",cursor:"pointer",backgroundColor:"rgba(0,0,0,0.6)",zIndex:"1","@media only screen and (max-width:767px)":{fontSize:"13px"}}),children:"AIで画像を生成する"}),(0,o.tZ)("div",{className:d().title,children:(0,o.tZ)(v.Z,{type:"絵トリス",vh:13.5,fontColor:16777215})}),(0,o.BX)("div",{className:d().contentWrapper,children:[(0,o.tZ)(u.Z,{className:d().uploader,onDrop:e=>{let t=window.URL.createObjectURL(e[0]);r(t),sessionStorage.setItem("modelImage",t)},children:(0,o.BX)("div",{className:d().uploader__wrapper,css:(0,p.iv)({position:"relative"}),children:[(0,o.tZ)("div",{css:(0,p.iv)({height:"100%",display:n?"block":"none"}),children:(0,o.tZ)("img",{alt:"",className:d().uploader__img,src:n||""})}),(0,o.BX)("div",{css:(0,p.iv)({display:n?"none":"block"}),children:[(0,o.tZ)(f.Z,{speed:.5,json:h}),(0,o.tZ)("img",{alt:"クリックして画像をアップロードしてください",src:"/img/icon/upload.png",css:(0,p.iv)({position:"absolute",left:"0",right:"0",top:"0",bottom:"0",margin:"auto",width:"13%"})})]})]})}),(0,o.tZ)("div",{className:d().playSetting,children:(0,o.tZ)(M.Z,{labelMaxStringNum:4,settings:[{label:"回転",rollProps:{initLabel:s,options:c.LA.USE_ROTATE,clickCallBack:(e,t)=>{g(t),sessionStorage.setItem("useRotate",t)},valueStringNum:4}},{label:"自動落下",rollProps:{initLabel:x,options:c.LA.FALL_SPEED,clickCallBack:(e,t)=>{y(t),sessionStorage.setItem("fallSpeed",t)},valueStringNum:4}},{label:"分割数",rollProps:{initLabel:S,options:c.LA.DIVIDER_NUM,clickCallBack:(e,t)=>{I(t),sessionStorage.setItem("divider",t)},valueStringNum:4}}]})}),(0,o.BX)("div",{className:"".concat(d().playButtomWrapper," ").concat(n?d().playButtomWrapper__onImage:""),onClick:()=>{n&&e.push({pathname:"play",query:{MODEL_IMAGE:n,USE_ROTATE:s,FALL_SPEED:x,DIVIDER_NUM:S}})},children:[(0,o.tZ)("span",{className:d().playImg}),(0,o.tZ)("span",{className:d().playButton,children:"この画像で遊ぶ"})]})]})]})]})}}},function(e){e.O(0,[296,802,737,260,115,664,901,351,253,774,888,179],function(){return e(e.s=8992)}),_N_E=e.O()}]);